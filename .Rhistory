dat<-read.csv("femaleMiceWeights.csv")
View(dat)
controls<-filter(dat,Diet=="chow")
View(controls)
controls<-filter(dat,Diet=="chow")
dat<-read.csv("femaleMiceWeights.csv")
View(dat)
library(dplyr)
View(dat)
controls<-filter(dat,Diet=="chow")
View(controls)
select(controls,Bodyweight)
controls<-select(controls,Bodyweight)
unlist(controls)
controls<-filter(dat,Diet=="chow")%>%select(Bodyweight)%>%unlist(controls)
controls<-filter(dat,Diet=="chow")%>%select(Bodyweight)%>%unlist
mean(controls)
library(dplyr)
dat<-read.csv("femaleMiceWeights.csv")
controls<-filter(dat,Diet=="chow")%>%select(Bodyweight)%>%unlist
treatment<-filter(dat,Diet=="hf")%>%select(Bodyweight)%>%unlist
controls
treatment
mean(control)
mean(controls)
mean(treatment)
mean(treatment)-mean(controls)
population<-read.csv("femaleMiceWeights.csv")
population<-unnlist(population)
population<-unlist(population)
mean(sample(population,12))
mean(sample(population,12))
mean( sample(population,12))
population<-unlist(population)
population
mean( sample(population,12))
population<-read.csv("femaleControlsPopulation.csv")
population<-unlist(population)
population
mean( sample(population,12))
mean( sample(population,12))
mean( sample(population,12))
n<-10000
nulls<-vector("numeric",n)
for(i in 1:n)
controls<-sample(population,12)
treatment<-sample(population,12)
nulls[i]<-mean(treatment)-mean(controls)
mean(controls)
mean(nulls>obs)
obs<-mean(treatment)-mean(controls)
mean(nulls>obs)
mean(abs(nulls)>obs)
mean(nulls>obs)
nulls[i]<-mean(treatment)-mean(controls)
nulls[i]}
obs<-mean(treatment)-mean(controls)
obs
mean(controls)
mean(treatment)
obs
controls<-filter(dat,Diet=="chow")%>%select(Bodyweight)%>%unlist
treatment<-filter(dat,Diet=="hf")%>%select(Bodyweight)%>%unlist
controls
treatment
mean(controls)
mean(treatment)
obs<-mean(treatment)-mean(controls)
obs
population<-read.csv("femaleControlsPopulation.csv")
population<-unlist(population)
population
n<-10000
nulls<-vector("numeric",n)
for(i in 1:n)
{
controls<-sample(population,12)
treatment<-sample(population,12)
nulls[i]<-mean(treatment)-mean(controls)
}
mean(nulls>obs)
mean(abs(nulls)>obs)
mean(nulls>obs)
mean(abs(nulls)>obs)
controls
treatment
count(treatment)
hist(nulls)
hist(obs)
hist(nulls)
library(rafalib)
install.packages("rafalib")
library(rafalib)
mypar()
qqnorm(nulls)
qqline(nulls)
qqnorm(nulls)
qqnorm(nulls)
qqline(nulls)
library(dplyr)
dat<-read.csv("femaleMiceWeights.csv")
dat<-read.csv("femaleMiceWeights.csv")
controls<-filter(dat,Diet=="chow")%>%select(Bodyweight)%>%unlist
treatment<-filter(dat,Diet=="hf")%>%select(Bodyweight)%>%unlist
N<-length(treatment)
library(dplyr)
dat<-read.csv("femaleMiceWeights.csv")
controls<-filter(dat,Diet=="chow")%>%select(Bodyweight)%>%unlist
treatment<-filter(dat,Diet=="hf")%>%select(Bodyweight)%>%unlist
N<-length(treatment)
obs<-mean(treatment)-mean(controls)
se<-sqrt(var(treatment)/N+var(controls)/N)
tstat<-obs/se
pnorm(tstat)
2*(1-pnorm(tstat))
n<-10000
nulls<-vector("numeric",n)
for(i in 1:n)
{
controls<-sample(population,N)
treatment<-sample(population,N)
nulls[i]<-(mean(treatment)-mean(controls))/se
}
mean(nulls>obs)
mean(abs(nulls)>obs)
library(rafalib)
mypar()
qqnorm(nulls)
abline(0,1)
dat<-read.csv("femaleMiceWeights.csv")
controls<-filter(dat,Diet=="chow")%>%select(Bodyweight)%>%unlist
treatment<-filter(dat,Diet=="hf")%>%select(Bodyweight)%>%unlist
library(dplyr)
dat<-read.csv("femaleMiceWeights.csv")
controls<-filter(dat,Diet=="chow")%>%select(Bodyweight)%>%unlist
treatment<-filter(dat,Diet=="hf")%>%select(Bodyweight)%>%unlist
N<-length(treatment)
obs<-mean(treatment)-mean(controls)
se<-sqrt(var(treatment)/3+var(controls)/3)
tstat<-obs/se
pnorm(tstat)
2*(1-pnorm(tstat))
n<-10000
nulls<-vector("numeric",n)
for(i in 1:n)
{
controls<-sample(population,3)
treatment<-sample(population,3)
nulls[i]<-(mean(treatment)-mean(controls))/se
}
mean(nulls>obs)
mean(abs(nulls)>obs)
library(rafalib)
mypar()
qqnorm(nulls)
abline(0,1)
qqline(nulls)
qqnorm(nulls)
abline(0,1)
qqline(nulls)
population<-read.csv("femaleControlsPopulation.csv")
population<-unlist(population)
n<-10000
nulls<-vector("numeric",n)
for(i in 1:n)
{
controls<-sample(population,3)
treatment<-sample(population,3)
se<-sqrt(var(treatment)/3+var(controls)/3)
nulls[i]<-(mean(treatment)-mean(controls))/se
}
library(rafalib)
mypar()
qqnorm(nulls)
abline(0,1)
population<-read.csv("femaleControlsPopulation.csv")
population<-unlist(population)
n<-10000
nulls<-vector("numeric",n)
for(i in 1:n)
{
controls<-sample(population,N)
treatment<-sample(population,N)
se<-sqrt(var(treatment)/N+var(controls)/N)
nulls[i]<-(mean(treatment)-mean(controls))/se
}
library(rafalib)
mypar()
qqnorm(nulls)
abline(0,1)
qqline(nulls)
qqnorm(nulls)
abline(0,1)
library(dplyr)
dat<-read.csv("femaleMiceWeights.csv")
controls<-filter(dat,Diet=="chow")%>%select(Bodyweight)%>%unlist
treatment<-filter(dat,Diet=="hf")%>%select(Bodyweight)%>%unlist
ttest<-ttest(treatment,controls)
t.test<-t.test(treatment,controls)
ttest
library(dplyr)
dat<-read.csv("femaleMiceWeights.csv")
controls<-filter(dat,Diet=="chow")%>%select(Bodyweight)%>%unlist
treatment<-filter(dat,Diet=="hf")%>%select(Bodyweight)%>%unlist
t.test<-t.test(treatment,controls)
t.test
set.sed(1)
chowpopulation<-read.csv("femaleControlsPopulation.csv")
chowPopulation<-unlist(chowPopulation)
mu_chow<-mean(chowPopulation)
print(chowPopulation)
set.seed(1)
chowPopulation<-read.csv("femaleControlsPopulation.csv")
chowPopulation<-unlist(chowPopulation)
mu_chow<-mean(chowPopulation)
print(chowPopulation)
N<-30
interval
interval
set.seed(1)
chowPopulation<-read.csv("femaleControlsPopulation.csv")
chowPopulation<-unlist(chowPopulation)
mu_chow<-mean(chowPopulation)
print(chowPopulation)
N<-30
chow<-sample(chowPopulation,N)
print(mean(chow))
se<-sd(chow)/sqrt(N)
print(se)
(mean(chow)-mean(chowPopulation))/se
Q<-qnorm(1-0.05/2)
Q,N)
Q<-qnorm(1-0.05/2)
Q
interval<-c(mean(chow)-Q*se,mean(chow)+Q*se)
interval
interval[1]<mu_chow&interval[2]>mu_chow
library(rafalib)
B<-250
mypar()
plot(mean(chowPopulation)+c(-7,7),c(1,1),type="n",xlab="weights",ylab="interval",ylim=c(1,B))
abline(v=mean(chowPopulation))
for(i in 1:B)
{chow<-sample(chowPopulation,N)
se<-sd(chow)/sqrt(N)
interval<-c(mean(chow)-Q*se,mean(chow)+Q*se)
covered<-mean(chowPopulation)<=interval[2]+mean(chowPopulation)>=interval[1]
color<-ifelse(covered,1,2)
i=1
lines(interval,c(i,i),col=color)
}
chow<-sample(chowPopulation,N)
se<-sd(chow)/sqrt(N)
interval<-c(mean(chow)-Q*se,mean(chow)+Q*se)
covered<-mean(chowPopulation)<=interval[2]+mean(chowPopulation)>=interval[1]
color<-ifelse(covered,1,2)
covered<-mean(chowPopulation)<=interval[2]+mean(chowPopulation) >=interval[1]
covered<-mean(chowPopulation)<=interval[2]+mean(chowPopulation) >=interval[1]
covered
<-mean(chowPopulation)<=interval[2]+mean(chowPopulation) >=interval[1]
interval<-c(mean(chow)-Q*se,mean(chow)+Q*se)
covered <-mean(chowPopulation)<=interval[2]+mean(chowPopulation) >=interval[1]
chow <- sample(chowPopulation,N)
se <- sd(chow)/sqrt(N)
interval <- c(mean(chow)-Q*se, mean(chow)+Q*se)
covered <-
mean(chowPopulation) <= interval[2] & mean(chowPopulation) >= interval[1]
color <- ifelse(covered,1,2)
i=1lines(interval, c(i,i),col=color)
i=2
chow <- sample(chowPopulation,N)
se <- sd(chow)/sqrt(N)
interval <- c(mean(chow)-Q*se, mean(chow)+Q*se)
covered <-
mean(chowPopulation) <= interval[2] & mean(chowPopulation) >= interval[1]
color <- ifelse(covered,1,2)
i=2
chow <- sample(chowPopulation,N)
se <- sd(chow)/sqrt(N)
interval <- c(mean(chow)-Q*se, mean(chow)+Q*se)
covered <-
mean(chowPopulation) <= interval[2] & mean(chowPopulation) >= interval[1]
color <- ifelse(covered,1,2)
i=2
lines(interval, c(i,i),col=color)
for (i in 1:B) {
chow <- sample(chowPopulation,N)
se <- sd(chow)/sqrt(N)
interval <- c(mean(chow)-Q*se, mean(chow)+Q*se)
covered <-
mean(chowPopulation) <= interval[2] & mean(chowPopulation) >= interval[1]
color <- ifelse(covered,1,2)
lines(interval, c(i,i),col=color)
}
set.seed(1)
chowPopulation<-read.csv("femaleControlsPopulation.csv")
chowPopulation<-unlist(chowPopulation)
mu_chow<-mean(chowPopulation)
print(chowPopulation)
N<-5
chow<-sample(chowPopulation,N)
print(mean(chow))
se<-sd(chow)/sqrt(N)
print(se)
(mean(chow)-mean(chowPopulation))/se
Q<-qnorm(1-0.05/2)
Q
interval<-c(mean(chow)-Q*se,mean(chow)+Q*se)
interval
interval[1]<mu_chow&interval[2]>mu_chow
library(rafalib)
B <- 250
mypar()
plot(mean(chowPopulation)+c(-7,7),c(1,1),type="n",
xlab="weight",ylab="interval",ylim=c(1,B))
abline(v=mean(chowPopulation))
for (i in 1:B) {
chow <- sample(chowPopulation,N)
se <- sd(chow)/sqrt(N)
interval <- c(mean(chow)-Q*se, mean(chow)+Q*se)
covered <-
mean(chowPopulation) <= interval[2] & mean(chowPopulation) >= interval[1]
color <- ifelse(covered,1,2)
lines(interval, c(i,i),col=color)
}
